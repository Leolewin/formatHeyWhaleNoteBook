(()=>{!function(){const o=()=>{const e=document.querySelector(".notebook__content"),o=[...document.querySelectorAll(".cell__editor-wrapper")];GM_log(o.length),t(0,o,e)},t=(e,o,n)=>{if(e>=o.length)return n.scrollTop=0,void document.querySelector("ul.notebook__actions").childNodes[0].click();const l=o[e];l.scrollIntoView(),l.click(),n.scrollTop=n.scrollTop-20,GM_log("scroll to:",l,e),setTimeout((()=>{l.parentNode.parentNode.querySelector(".cell__toolbar").childNodes[2].click()}),0),setTimeout((()=>{t(e+1,o,n)}),500)},n=()=>{const t=setTimeout((()=>{const l=document.getElementsByClassName("download-progress__btn").length>0;if(GM_log("isDownloading",l),l)return clearTimeout(t),n();(()=>{unsafeWindow.window.$pangu=pangu;const e=document.querySelector(".header"),t=e.childNodes[e.childNodes.length-1].querySelectorAll("button")[0],n=t.cloneNode(!0);n.textContent="Format Notebook",t.parentNode.prepend(n),n.setAttribute("style","background-color: #0969da !important; color: white;"),n.onclick=o})(),e()}),5e3)};n()}();const e=()=>{let e=!1;const o=unsafeWindow.window.XMLHttpRequest.prototype.open,t=unsafeWindow.window.XMLHttpRequest.prototype.send;unsafeWindow.window.XMLHttpRequest.prototype.open=function(t,n,...l){GM_log(t,n),e="PUT"===t&&/(\/api\/notebooks\/).*/.test(n),o.apply(this,arguments)},unsafeWindow.window.XMLHttpRequest.prototype.send=function(o){try{const t=JSON.parse(o);t&&t?.Content?.cells.length&&(t.Content.cells=t.Content.cells.map(((e,o)=>("markdown"===e.cell_type&&(e.source=pangu.spacing(e.source),e.source=e.source.replace(/(\*\*)\s(.*?)\s(\*\*)/g,"$1$2$3").replace(/(\*)\s(.*?)\s(\*)/g,"$1$2$3"),e.source.match(/\[.*\]\(((https?:\/\/|www\.)(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?\)/gi)?.every((o=>(e.source=e.source.replaceAll(o,o.replaceAll(/\s+/g,"")),!0)))),"code"===e.cell_type&&(e.source=e.source.replace(/(\n)$/,"")),e))),GM_log("updateData",t),o=JSON.stringify(t),e=!1)}catch(e){}t.apply(this,[o])}}})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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cmNlcyI6WyJ3ZWJwYWNrOi8vZm9ybWF0aGV5d2hhbGVub3RlYm9vay8uL3NyYy9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKSB7XHJcbiAgY29uc3QgY3JlYXRlRm9ybWF0QnV0dG9uID0gKCkgPT4ge1xyXG4gICAgICB1bnNhZmVXaW5kb3cud2luZG93LiRwYW5ndSA9IHBhbmd1O1xyXG4gICAgICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyJyk7XHJcbiAgICAgIGNvbnN0IGxlZnRDb21tYW5kcyA9IGhlYWRlci5jaGlsZE5vZGVzW2hlYWRlci5jaGlsZE5vZGVzLmxlbmd0aCAtIDFdO1xyXG4gICAgICBjb25zdCBsZWZ0Q29tbWFuZHNCdXR0b25zID0gbGVmdENvbW1hbmRzLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpO1xyXG4gICAgICBjb25zdCBnaG9zdE5vZGUgPSBsZWZ0Q29tbWFuZHNCdXR0b25zWzBdO1xyXG4gICAgICBjb25zdCBmb3JtYXROb2RlID0gZ2hvc3ROb2RlLmNsb25lTm9kZSh0cnVlKTtcclxuICAgICAgZm9ybWF0Tm9kZS50ZXh0Q29udGVudCA9IFwiRm9ybWF0IE5vdGVib29rXCI7XHJcbiAgICAgIGdob3N0Tm9kZS5wYXJlbnROb2RlLnByZXBlbmQoZm9ybWF0Tm9kZSk7XHJcbiAgICAgIGZvcm1hdE5vZGUuc2V0QXR0cmlidXRlKCAnc3R5bGUnLCAnYmFja2dyb3VuZC1jb2xvcjogIzA5NjlkYSAhaW1wb3J0YW50OyBjb2xvcjogd2hpdGU7Jyk7XHJcbiAgICAgIGZvcm1hdE5vZGUub25jbGljayA9IGZvcm1hdFBhZ2U7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgZm9ybWF0UGFnZSA9ICgpID0+IHtcclxuICAgICAgY29uc3QgY29udGVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ub3RlYm9va19fY29udGVudCcpO1xyXG4gICAgICBjb25zdCBweXRob25Db2RlY2hpbGRzID0gWy4uLmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jZWxsX19lZGl0b3Itd3JhcHBlcicpXTtcclxuICAgICAgR01fbG9nKHB5dGhvbkNvZGVjaGlsZHMubGVuZ3RoKTtcclxuICAgICAgZm9ybWF0Q29kZSgwLCBweXRob25Db2RlY2hpbGRzLCBjb250ZW50KTtcclxuICB9XHJcblxyXG4gIGNvbnN0IGZvcm1hdENvZGUgPSAoaWR4LCBpdGVtcywgY29udGVudCkgPT4ge1xyXG4gICAgICBpZiAoaWR4ID49IGl0ZW1zLmxlbmd0aCkge1xyXG4gICAgICAgIGNvbnRlbnQuc2Nyb2xsVG9wID0gMDtcclxuICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCd1bC5ub3RlYm9va19fYWN0aW9ucycpLmNoaWxkTm9kZXNbMF0uY2xpY2soKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgY2hpbGQgPSBpdGVtc1tpZHhdO1xyXG4gICAgICBjaGlsZC5zY3JvbGxJbnRvVmlldygpO1xyXG4gICAgICBjaGlsZC5jbGljaygpO1xyXG4gICAgICBjb250ZW50LnNjcm9sbFRvcCA9IGNvbnRlbnQuc2Nyb2xsVG9wIC0gMjA7XHJcbiAgICAgIEdNX2xvZygnc2Nyb2xsIHRvOicsIGNoaWxkLCBpZHgpO1xyXG5cclxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAvLyBmb3JtYXQgdGhlIHB5dGhvbiBjb2RlIGJ5IGNsaWNrIHRoZSBwYWdlIHByZXR0eSBidXR0b25cclxuICAgICAgICAgIGNoaWxkLnBhcmVudE5vZGUucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKCcuY2VsbF9fdG9vbGJhcicpLmNoaWxkTm9kZXNbMl0uY2xpY2soKTtcclxuICAgICAgfSwgMClcclxuXHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgZm9ybWF0Q29kZShpZHggKyAxLCBpdGVtcywgY29udGVudCk7XHJcbiAgICAgIH0sIDUwMClcclxuICB9XHJcblxyXG4gIGNvbnN0IGluaXQgPSAoKSA9PiB7XHJcbiAgICBjb25zdCB0aW1lciA9IHNldFRpbWVvdXQoKCkgPT57XHJcbiAgICAgIGNvbnN0IGlzRG93bmxvYWRpbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdkb3dubG9hZC1wcm9ncmVzc19fYnRuJykubGVuZ3RoID4gMDtcclxuICAgICAgR01fbG9nKCdpc0Rvd25sb2FkaW5nJywgaXNEb3dubG9hZGluZyk7XHJcbiAgICAgIGlmIChpc0Rvd25sb2FkaW5nKSB7XHJcbiAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTtcclxuICAgICAgICByZXR1cm4gaW5pdCgpO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGNyZWF0ZUZvcm1hdEJ1dHRvbigpO1xyXG4gICAgICAgIGZvcm1hdEJ5U2F2KCk7XHJcbiAgICAgIH1cclxuICAgIH0sIDUwMDApXHJcbiAgfTtcclxuXHJcbiAgaW5pdCgpO1xyXG4gIC8vIFlvdXIgY29kZSBoZXJlLi4uXHJcbn0pKCk7XHJcblxyXG5cclxuXHJcbmNvbnN0IGZvcm1hdEJ5U2F2ID0gKCkgPT4ge1xyXG4gIGxldCBzaG91bGRGb3JtYXQgPSBmYWxzZTtcclxuICBjb25zdCBvcmlnaW5PcGVuID0gdW5zYWZlV2luZG93LndpbmRvdy5YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUub3BlbjtcclxuICBjb25zdCBvcmlnaW5TZW5kID0gdW5zYWZlV2luZG93LndpbmRvdy5YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuc2VuZDtcclxuICB1bnNhZmVXaW5kb3cud2luZG93LlhNTEh0dHBSZXF1ZXN0LnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24gKG1ldGhvZCwgdXJsLCAuLi5hcmdzKSB7XHJcbiAgICBHTV9sb2cobWV0aG9kLCB1cmwpXHJcbiAgICBzaG91bGRGb3JtYXQgPSBtZXRob2QgPT09ICdQVVQnICYmIC8oXFwvYXBpXFwvbm90ZWJvb2tzXFwvKS4qLy50ZXN0KHVybCk7XHJcbiAgICBvcmlnaW5PcGVuLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XHJcbiAgfTtcclxuXHJcbiAgdW5zYWZlV2luZG93LndpbmRvdy5YTUxIdHRwUmVxdWVzdC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1cGRhdGVEYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcclxuICAgICAgaWYgKHVwZGF0ZURhdGEgJiYgdXBkYXRlRGF0YT8uQ29udGVudD8uY2VsbHMubGVuZ3RoKVxyXG4gICAgICB7XHJcbiAgICAgICAgdXBkYXRlRGF0YS5Db250ZW50LmNlbGxzID0gdXBkYXRlRGF0YS5Db250ZW50LmNlbGxzLm1hcCgoY2VsbCwgaWR4KSA9PiB7XHJcbiAgICAgICAgICBpZiAoY2VsbC5jZWxsX3R5cGUgPT09ICdtYXJrZG93bicpIHtcclxuICAgICAgICAgICAgY2VsbC5zb3VyY2UgPSBwYW5ndS5zcGFjaW5nKGNlbGwuc291cmNlKTtcclxuICAgICAgICAgICAgY2VsbC5zb3VyY2UgPSBjZWxsLnNvdXJjZS5yZXBsYWNlKC8oXFwqXFwqKVxccyguKj8pXFxzKFxcKlxcKikvZywgJyQxJDIkMycpLnJlcGxhY2UoLyhcXCopXFxzKC4qPylcXHMoXFwqKS9nLCAnJDEkMiQzJyk7XHJcblxyXG4gICAgICAgICAgICBjZWxsLnNvdXJjZS5tYXRjaCgvXFxbLipcXF1cXCgoKGh0dHBzPzpcXC9cXC98d3d3XFwuKSgoW2EtekEtWjAtOV0rLT8pK1thLXpBLVowLTldK1xcLikrW2EtekEtWl0rKSg6XFxkKyk/KFxcLy4qKT8oXFw/LiopPygjLiopP1xcKS9pZylcclxuICAgICAgICAgICAgICA/LmV2ZXJ5KHVybCA9PiB7XHJcbiAgICAgICAgICAgICAgICBjZWxsLnNvdXJjZSA9IGNlbGwuc291cmNlLnJlcGxhY2VBbGwodXJsLCB1cmwucmVwbGFjZUFsbCgvXFxzKy9nLCAnJykpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBpZiAoY2VsbC5jZWxsX3R5cGUgPT09ICdjb2RlJykge1xyXG4gICAgICAgICAgICBjZWxsLnNvdXJjZSA9IGNlbGwuc291cmNlLnJlcGxhY2UoLyhcXG4pJC8sICcnKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBjZWxsO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBHTV9sb2coJ3VwZGF0ZURhdGEnLCB1cGRhdGVEYXRhKVxyXG4gICAgICAgIGRhdGEgPSBKU09OLnN0cmluZ2lmeSh1cGRhdGVEYXRhKTtcclxuICAgICAgICBzaG91bGRGb3JtYXQgPSBmYWxzZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgY2F0Y2ggKGVycikge31cclxuICAgIG9yaWdpblNlbmQuYXBwbHkodGhpcywgW2RhdGFdKTtcclxuICB9O1xyXG59OyJdLCJuYW1lcyI6WyJmb3JtYXRQYWdlIiwiY29udGVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInB5dGhvbkNvZGVjaGlsZHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiR01fbG9nIiwibGVuZ3RoIiwiZm9ybWF0Q29kZSIsImlkeCIsIml0ZW1zIiwic2Nyb2xsVG9wIiwiY2hpbGROb2RlcyIsImNsaWNrIiwiY2hpbGQiLCJzY3JvbGxJbnRvVmlldyIsInNldFRpbWVvdXQiLCJwYXJlbnROb2RlIiwiaW5pdCIsInRpbWVyIiwiaXNEb3dubG9hZGluZyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJjbGVhclRpbWVvdXQiLCJ1bnNhZmVXaW5kb3ciLCJ3aW5kb3ciLCIkcGFuZ3UiLCJwYW5ndSIsImhlYWRlciIsImdob3N0Tm9kZSIsImZvcm1hdE5vZGUiLCJjbG9uZU5vZGUiLCJ0ZXh0Q29udGVudCIsInByZXBlbmQiLCJzZXRBdHRyaWJ1dGUiLCJvbmNsaWNrIiwiY3JlYXRlRm9ybWF0QnV0dG9uIiwiZm9ybWF0QnlTYXYiLCJzaG91bGRGb3JtYXQiLCJvcmlnaW5PcGVuIiwiWE1MSHR0cFJlcXVlc3QiLCJwcm90b3R5cGUiLCJvcGVuIiwib3JpZ2luU2VuZCIsInNlbmQiLCJtZXRob2QiLCJ1cmwiLCJhcmdzIiwidGVzdCIsImFwcGx5IiwidGhpcyIsImFyZ3VtZW50cyIsImRhdGEiLCJ1cGRhdGVEYXRhIiwiSlNPTiIsInBhcnNlIiwiQ29udGVudCIsImNlbGxzIiwibWFwIiwiY2VsbCIsImNlbGxfdHlwZSIsInNvdXJjZSIsInNwYWNpbmciLCJyZXBsYWNlIiwibWF0Y2giLCJldmVyeSIsInJlcGxhY2VBbGwiLCJzdHJpbmdpZnkiLCJlcnIiXSwic291cmNlUm9vdCI6IiJ9